<div class="container">
  <h2 class="titulo">Planes de Intervenci√≥n</h2>
  <p>Administra los planes de intervenci√≥n y sus evaluaciones.</p>

  <div class="search-box">
      <input [(ngModel)]="searchText" (input)="filtrarPlanes()" type="text" placeholder="Buscar plan..." />

      <select [(ngModel)]="selectedLinea" (change)="filtrarPlanes()">
          <option value="">Todas las l√≠neas</option>
          <option *ngFor="let linea of lineas" [value]="linea.id">{{ linea.nombre }}</option>
      </select>

      <button (click)="filtrarPlanes()">
          <span>Buscar</span> <i class="icono-buscar">‚ûï</i>
      </button>
  </div>

  <div *ngFor="let plan of filteredPlanes" class="plan">
      <div class="plan-header">
          <div class="mispan" style="display: grid;">
              <span class="titulo">{{ plan.nombre }}</span>
              <span>L√≠nea de intervenci√≥n - <strong>{{ getLineaNombre(plan.linea_id) }}</strong></span>
          </div>
          <div class="menu">
              <button (mouseenter)="toggleMenu(plan.id)" class="btn-menu">‚öô</button>
              <div *ngIf="activeMenuId === plan.id" class="menu-opciones">
                  <button *ngIf="expandedId !== plan.id" (click)="expandirPlan(plan.id)">Expandir</button>
                  <button *ngIf="expandedId === plan.id" (click)="minimizarPlan()">Minimizar</button>
                  <button *ngIf="expandedId === plan.id" (click)="editarPlan(plan.id)">Editar</button>
                  <button *ngIf="expandedId === plan.id" (click)="refrescar()">Refrescar</button>
              </div>
          </div>
      </div>

      <div *ngIf="expandedId === plan.id" class="detalles">
          <p><strong>Descripci√≥n:</strong> {{ plan.descripcion }}</p>

          <h4>Evaluaciones</h4>
          <ul>
              <li *ngFor="let evaluacion of plan.evaluaciones">
                  <strong>{{ evaluacion.nombre }}</strong>
                  <ul>
                      <li *ngFor="let pregunta of evaluacion.preguntas">
                          - {{ pregunta.pregunta }}
                      </li>
                  </ul>
              </li>
          </ul>
      </div>
  </div>

  <!-- üìå Paginaci√≥n -->
  <div class="pagination">
      <button class="volver" (click)="irAPagina(currentPage - 1)" [disabled]="currentPage === 1">Anterior</button>
      <span>P√°gina {{ currentPage }} de {{ totalPages }}</span>
      <button class="ir" (click)="irAPagina(currentPage + 1)" [disabled]="currentPage === totalPages">Siguiente</button>
  </div>
</div>
